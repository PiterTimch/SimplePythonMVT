{% extends "layout.html" %}

{% block content %}
<h1 class="text-center">Редагування: {{ category.name }}</h1>

<form method="POST" enctype="multipart/form-data">
  {% csrf_token %}
  {{ form.as_p }}

  <div class="d-flex flex-row">
    <button type="submit" class="btn btn-primary me-2">Save Changes</button>
    <a href="{% url 'categories:show_categories' %}" class="btn btn-secondary">Cancel</a>
  </div>
</form>
{% endblock %}


{% comment %} {% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-center align-items-center min-vh-100">
    <div class="card shadow-lg p-4" style="max-width: 500px; width: 100%; background-color: #fffaf5;">
        <h1 class="text-center mb-4" style="color: #6b4226;">Редагувати категорію</h1>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="mb-3">
                {{ form.name.label_tag }}
                {{ form.name }}
                {% if form.name.errors %}
                    <div class="text-danger small">{{ form.name.errors }}</div>
                {% endif %}
            </div>

            <div class="mb-3">
                {{ form.slug.label_tag }}
                {{ form.slug }}
                {% if form.slug.errors %}
                    <div class="text-danger small">{{ form.slug.errors }}</div>
                {% endif %}
            </div>

            <div class="mb-3">
                {{ form.image.label_tag }}
                {{ form.image }}
                {% if form.image.errors %}
                    <div class="text-danger small">{{ form.image.errors }}</div>
                {% endif %}

                <div class="mt-3 text-center">
                    <button type="button" id="removeImageBtn" 
                            class="btn btn-sm btn-outline-danger mt-2 d-none">
                        Видалити
                    </button>
                    <img id="imagePreview" 
                         src="" 
                         alt="Прев'ю зображення" 
                         class="img-fluid rounded shadow-sm d-none"
                         style="width: 200px; height: 200px; object-fit: cover; border: 2px solid #e2d1c3;" />
                </div>
            </div>
            
            <div class="d-grid">
                <button type="submit" class="btn btn-lg" 
                        style="background-color: #8b5e3c; color: #fff; border: none;">
                    Редагувати
                </button>
            </div>
        </form>

    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const fileInput = document.querySelector("#id_image");
    const preview = document.getElementById("imagePreview");
    const removeBtn = document.getElementById("removeImageBtn");

    fileInput.addEventListener("change", function() {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.classList.remove("d-none");
                removeBtn.classList.remove("d-none");
            }
            reader.readAsDataURL(file);
        } else {
            preview.src = "";
            preview.classList.add("d-none");
            removeBtn.classList.add("d-none");
        }
    });

    removeBtn.addEventListener("click", function() {
        fileInput.value = "";
        preview.src = "";
        preview.classList.add("d-none");
        removeBtn.classList.add("d-none");
    });
});
</script>

{% endblock content %} {% endcomment %}